# SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>
#
# SPDX-License-Identifier: AGPL-3.0-only

repos:
  - repo: https://github.com/compilerla/conventional-pre-commit
    rev: v1.2.0
    hooks:
      - id: conventional-pre-commit
        stages: [commit-msg]
        args: []

  - repo: https://github.com/fsfe/reuse-tool
    rev: v0.14.0
    hooks:
      - id: reuse

  - repo: local
    hooks:
      - id: check-if-version-is-snapshot
        name: check-if-version-is-snapshot
        entry: bash -c '
          currentBranch=$(git branch --show-current)
          isSnapshot=$(grep -re "pkgrel=\"SNAPSHOT\"" package/PKGBUILD)

          if [[ "$currentBranch" != *"release"* && -z "$isSnapshot" ]] ||
             [[ "$currentBranch" == *"release"* && -n "$isSnapshot" ]];
          then
            exit 1;
          fi'
        language: system
